<% layout('layout', { title: '–ü–æ–¥–∫–ª—é—á–∏—Ç—å Telegram - VolunteerHub' }) %>

<div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-8">
    <div class="text-center mb-8">
      <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
        <i data-lucide="smartphone" class="w-10 h-10 text-blue-600"></i>
      </div>
      <h1 class="text-2xl font-bold text-slate-900 mb-2">–ü–æ–¥–∫–ª—é—á–∏—Ç—å Telegram</h1>
      <p class="text-slate-600">
        –ü–æ–ª—É—á–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ —É—á–∞—Å—Ç–∏–µ–º –≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö –ø—Ä—è–º–æ –≤ Telegram
      </p>
    </div>

    <div class="space-y-6 mb-8">
      <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
        <h3 class="font-semibold text-emerald-800 mb-2">‚úÖ –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:</h3>
        <ul class="text-sm text-emerald-700 space-y-1">
          <li>‚Ä¢ –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö</li>
          <li>‚Ä¢ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Å–º–µ–Ω</li>
          <li>‚Ä¢ –ë—ã—Å—Ç—Ä—ã–π —á–µ–∫-–∏–Ω —á–µ—Ä–µ–∑ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é</li>
          <li>‚Ä¢ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É—á–∞—Å—Ç–∏—è –ø—Ä—è–º–æ –≤ —á–∞—Ç–µ</li>
          <li>‚Ä¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ –±–µ–∑ –≤—Ö–æ–¥–∞ –Ω–∞ —Å–∞–π—Ç</li>
        </ul>
      </div>

      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <h3 class="font-semibold text-blue-800 mb-2">üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:</h3>
        <ul class="text-sm text-blue-700 space-y-1">
          <li>‚Ä¢ –ú—ã –Ω–µ –ø–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –≤–∞—à–∏–º —Å–æ–æ–±—â–µ–Ω–∏—è–º</li>
          <li>‚Ä¢ –¢–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è (–∏–º—è, username)</li>
          <li>‚Ä¢ –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç</li>
          <li>‚Ä¢ –î–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º Telegram</li>
        </ul>
      </div>
    </div>

    <div class="border border-slate-200 rounded-lg p-6 mb-6">
      <h3 class="font-semibold text-slate-900 mb-4">–®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞</h3>
      <p class="text-sm text-slate-600 mb-4">
        –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram –∏ —Å–≤—è–∑–∞—Ç—å –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç:
      </p>
      
      <div id="telegram-login-container" class="flex justify-center">
        <%- it.telegramWidget %>
      </div>
    </div>

    <div class="border border-slate-200 rounded-lg p-6">
      <h3 class="font-semibold text-slate-900 mb-4">–®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞</h3>
      <p class="text-sm text-slate-600 mb-4">
        –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞–π–¥–∏—Ç–µ –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ:
      </p>
      
      <div class="flex items-center justify-between bg-slate-50 rounded-lg p-4">
        <div class="flex items-center space-x-3">
          <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center">
            <i data-lucide="bot" class="w-6 h-6 text-white"></i>
          </div>
          <div>
            <p class="font-medium text-slate-900">@<%= it.botUsername %></p>
            <p class="text-sm text-slate-600">VolunteerHub Bot</p>
          </div>
        </div>
        <a 
          href="https://t.me/<%= it.botUsername %>" 
          target="_blank"
          class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors"
        >
          –û—Ç–∫—Ä—ã—Ç—å –≤ Telegram
        </a>
      </div>
    </div>

    <div class="mt-8 flex justify-center">
      <a 
        href="/account" 
        class="text-slate-600 hover:text-slate-900 text-sm font-medium transition-colors"
      >
        ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
      </a>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    lucide.createIcons();
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
    const urlParams = new URLSearchParams(window.location.search);
    const error = urlParams.get('error');
    const success = urlParams.get('success');
    
    if (error === 'telegram_auth_failed') {
      showToast('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Telegram. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.', 'error');
    } else if (error === 'telegram_already_linked') {
      showToast('–≠—Ç–æ—Ç Telegram –∞–∫–∫–∞—É–Ω—Ç —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –¥—Ä—É–≥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.', 'error');
    } else if (success === 'telegram_connected') {
      showToast('Telegram —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω!', 'success');
      setTimeout(() => {
        window.location.href = '/account';
      }, 2000);
    }
  });
</script>
